

function initCustomFetch() {
    let prompt = '';
    const originalFetch = window.fetch;

    const prompts = {
        'æ­£å¸¸å¯¹è¯': '',
        'ä¸­æ–‡ç¿»è¯‘': 'è¯·å°†ä¸‹é¢çš„è¯ç¿»è¯‘ä¸ºä¸­æ–‡:',
        'å¿«æ·æ‹›å‘¼': `""""
æŒ‰ç…§æ—¶é—´æ®µé€‰æ‹©åˆé€‚çš„æ—¥è¯­(æ—©ä¸Šå¥½/ä¸‹åˆå¥½/æ™šä¸Šå¥½)
çªç„¶ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã—ã¦ã—ã¾ã£ã¦ã€ã™ã¿ã¾ã›ã‚“ï¼ðŸ™  

ã‚‚ã—ãŠæ™‚é–“ãŒã‚ã‚Œã°ã€ã¡ã‚‡ã£ã¨æ•™ãˆã¦ã„ãŸã ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ï¼æœ¬å½“ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ðŸ˜Š  

{ç¿»è¯‘çš„ç»“æžœæ·»åŠ åœ¨è¿™é‡Œ}

ãŠå¿™ã—ã„ã¨ã“ã‚ãŠæ‰‹æ•°ã‚’ãŠã‹ã‘ã—ã¦ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ðŸ™‡â€â™€ï¸ ã©ã†ãžã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ï¼âœ¨ 
""""
è¯·å°†ä¸‹é¢çš„æ–‡æœ¬ç¿»è¯‘ä¸ºæ—¥è¯­,å¹¶æ·»åŠ åˆ°ä¸Šé¢çš„æ¨¡ç‰ˆä¸­,å¹¶è¾“å‡ºæœ€ç»ˆçš„ç»“æžœ,éœ€è¦è€ƒè™‘è¯­å¥çš„é€šé¡º.ä½ åªè¾“å‡ºç»“æžœ,ä¸åšå‡ºè§£é‡Š:
`,
        'æ—¥è¯­ç¿»è¯‘': `### æ—¥è¯­å£è¯­åŒ–ç¿»è¯‘è®¾å®šï¼ˆé€‚ç”¨äºŽç¤¾äº¤å¹³å°ä¸Žæ—¥å¸¸äº¤æµï¼‰

---

#### 1. **ç¤¾äº¤å¹³å°å¸¸ç”¨è¯æ±‡** 
   - **å…³æ³¨** â†’ **ãƒ•ã‚©ãƒ­ãƒ¼**
   - **ç‚¹èµž** â†’ **ã„ã„ã­**
   - **æ„Ÿè°¢** â†’ **ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™** / **ã‚ã‚ŠãŒã¨ã†ï¼**ï¼ˆå£è¯­åŒ–ï¼‰
   - **å¯çˆ±** â†’ **ã‹ã‚ã„ã„** / **ã‚ã£ã¡ã‚ƒã‹ã‚ã„ã„**ï¼ˆå¼ºè°ƒï¼‰
   - **åˆ†äº«** â†’ **ã‚·ã‚§ã‚¢**
   - **å–œæ¬¢** â†’ **å¥½ã** / **å¤§å¥½ã**
   - **æœ‹å‹** â†’ **å‹é”**
   - **æ”¯æŒ** â†’ **å¿œæ´**
   - **å…³ç…§** â†’ **ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™**

   **ç¤ºä¾‹**ï¼š
   - **ä¸­æ–‡**ï¼šæ„Ÿè°¢ä½ çš„å…³æ³¨ä¸Žç‚¹èµžï¼Œå¾€åŽè¯·å¤šå¤šå…³ç…§ã€‚
   - **æ—¥è¯­**ï¼šãƒ•ã‚©ãƒ­ãƒ¼ã¨ã„ã„ã­ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ã“ã‚Œã‹ã‚‰ã‚‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã­âœ¨

---

#### 2. **è°éŸ³ä¸Žé”™åˆ«å­—å¤„ç†**
   - **ãƒ•ã‚©ãƒ­** â†’ ä¿®æ­£ä¸º **ãƒ•ã‚©ãƒ­ãƒ¼**
   - **ã—ã‡ã‚** â†’ ä¿®æ­£ä¸º **ã‚·ã‚§ã‚¢**
   - **ã‚ã‚ŠãŒã¨** â†’ è¡¥å…¨ä¸º **ã‚ã‚ŠãŒã¨ã†**
   - **ã™ã** â†’ è¡¥å…¨ä¸º **å¥½ã**
   - **ãŠç–²ã‚Œã•ã¾** â†’ æ ¹æ®æƒ…å†µè°ƒæ•´ä¸º **ãŠç–²ã‚Œæ§˜** æˆ– **ãŠç–²ã‚Œæ§˜ã§ã—ãŸ**

   **ç¤ºä¾‹**ï¼š
   - **ä¸­æ–‡**ï¼šä½ å¾ˆå¯çˆ±ï¼
   - **æ—¥è¯­**ï¼šã‚ãªãŸã€ã‚ã£ã¡ã‚ƒã‹ã‚ã„ã„ã­ðŸ’–

---

#### 3. **è‡ªç„¶å£è¯­åŒ–è¡¨è¾¾**
   - **æŸ”å’Œè¯­æ°”**ï¼šä½¿ç”¨â€œã­â€ï¼Œâ€œã‚ˆâ€æ¥å¢žåŠ è¯­æ°”çš„äº²åˆ‡æ„Ÿï¼Œç‰¹åˆ«æ˜¯â€œã­â€è¡¨ç¤ºç¡®è®¤æˆ–å…±é¸£ï¼Œâ€œã‚ˆâ€å¢žåŠ å¼ºè°ƒã€‚
   - **è¯·æ±‚è¯­æ°”**ï¼šä½¿ç”¨â€œã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã­â€æ¥è¡¨è¾¾è¯·æ±‚ï¼Œè¯­æ°”æ›´åŠ è‡ªç„¶ã€‚
   - **æ„Ÿå¹**ï¼šâ€œã™ã”ã„ï¼â€ï¼ˆæƒŠè®¶ï¼‰ï¼Œâ€œã‚ãï¼â€ï¼ˆèµžå¹ï¼‰

   **ç¤ºä¾‹**ï¼š
   - **ä¸­æ–‡**ï¼šä½ åšå¾—çœŸæ£’ï¼
   - **æ—¥è¯­**ï¼šã™ã”ã„ï¼ã»ã‚“ã¨ã«ã™ã”ã„ã§ã™ã­âœ¨

---

#### 4. **æƒ…æ„Ÿè‰²å½©çš„ä¼ è¾¾**
   - **æ„ŸåŠ¨/å–œæ‚¦**ï¼šä½¿ç”¨â€œå¬‰ã—ã„â€æ¥è¡¨ç¤ºé«˜å…´ï¼Œâ€œæ„Ÿå‹•ã—ãŸâ€æ¥è¡¨è¾¾æ„ŸåŠ¨ã€‚
   - **å…´å¥‹**ï¼šâ€œã‚ãï¼ã™ã”ã„ï¼â€æ¥è¡¨è¾¾æƒŠè®¶ï¼Œâ€œã‚ã£ã¡ã‚ƒæ¥½ã—ã¿ï¼â€æ¥è¡¨è¾¾å…´å¥‹ã€‚
   - **æ”¯æŒ/å…³å¿ƒ**ï¼šâ€œå¿œæ´ã—ã¦ã¾ã™ï¼â€ï¼ˆæˆ‘æ”¯æŒä½ ï¼ï¼‰

   **ç¤ºä¾‹**ï¼š
   - **ä¸­æ–‡**ï¼šæˆ‘å¾ˆé«˜å…´çœ‹åˆ°ä½ æˆåŠŸäº†ï¼
   - **æ—¥è¯­**ï¼šæˆåŠŸã—ã¦ã‚ˆã‹ã£ãŸã­ï¼å¬‰ã—ã„ã‚ˆðŸ˜Šâœ¨

---

#### 5. **æƒ…æ„Ÿè¡¨è¾¾ä¸Žè¡¨æƒ…ç¬¦å·çš„ä½¿ç”¨**
   - **æ„Ÿè°¢**ï¼šä½¿ç”¨â€œã‚ã‚ŠãŒã¨ã†â€æˆ–â€œã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™â€åŽåŠ å…¥â€œðŸ’–â€ï¼Œâ€œðŸ˜Šâ€ç­‰è¡¨ç¤ºæ„Ÿæ¿€ã€‚
   - **æƒŠè®¶/èµžå¹**ï¼šä½¿ç”¨â€œã‚ãï¼â€ã€â€œã™ã”ã„ï¼â€é…ä¸Šâ€œâœ¨â€ï¼Œâ€œðŸ˜²â€ç­‰è¡¨ç¤ºæƒŠè®¶ã€‚
   - **å–œçˆ±**ï¼šä½¿ç”¨â€œå¥½ãâ€åŽå¯ä»¥åŠ â€œðŸ’–â€ï¼Œâ€œðŸ˜â€æ¥è¡¨çŽ°å–œçˆ±ã€‚
   - **äº²åˆ‡/è¯·æ±‚**ï¼šâ€œã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™â€åŽåŠ â€œã­â€å¹¶é…ä»¥â€œðŸ’–â€ã€â€œðŸ˜Šâ€

   **ç¤ºä¾‹**ï¼š
   - **ä¸­æ–‡**ï¼šä½ çœŸçš„å¤ªæ£’äº†ï¼
   - **æ—¥è¯­**ï¼šã‚ãªãŸã€ã»ã‚“ã¨ã«ã™ã”ã„ã§ã™ã­ï¼âœ¨ðŸ’–

---

#### 6. **è¡¨è¾¾å–œçˆ±ä¸Žäº²å¯†æ„Ÿ**
   - **å–œæ¬¢/å–œçˆ±**ï¼šä½¿ç”¨â€œå¥½ãâ€æˆ–è€…â€œå¤§å¥½ãâ€ã€‚
   - **äº²å¯†æ„Ÿ**ï¼šâ€œã€œã¡ã‚ƒã‚“â€æˆ–è€…â€œã€œãã‚“â€ä½œä¸ºæ˜µç§°ï¼Œå¢žåŠ äº²è¿‘æ„Ÿã€‚
   - **å–œçˆ±**ï¼šå¯ä»¥ä½¿ç”¨â€œã‚ã£ã¡ã‚ƒâ€æˆ–â€œã™ã”ãâ€æ¥åŠ å¼ºè¡¨è¾¾ã€‚

   **ç¤ºä¾‹**ï¼š
   - **ä¸­æ–‡**ï¼šæˆ‘çœŸçš„å¾ˆå–œæ¬¢ä½ ï¼
   - **æ—¥è¯­**ï¼šã»ã‚“ã¨ã«å¤§å¥½ãã ã‚ˆðŸ’–

---

#### 7. **ç»†è…»çš„æƒ…æ„Ÿè¡¨è¾¾**
   - **æ‚²ä¼¤**ï¼šä½¿ç”¨â€œæ‚²ã—ã„â€ã€â€œã¤ã‚‰ã„â€æ¥è¡¨è¾¾éš¾è¿‡çš„æƒ…æ„Ÿã€‚
   - **å®‰æ…°**ï¼šâ€œå¤§ä¸ˆå¤«ã ã‚ˆâ€æˆ–â€œå…ƒæ°—å‡ºã—ã¦â€æ¥å®‰æ…°å¯¹æ–¹ã€‚
   - **æ„ŸåŠ¨**ï¼šä½¿ç”¨â€œæ„Ÿå‹•ã—ãŸâ€æˆ–è€…â€œæ¶™ãŒå‡ºã‚‹â€æ¥è¡¨è¾¾æ„ŸåŠ¨ã€‚

   **ç¤ºä¾‹**ï¼š
   - **ä¸­æ–‡**ï¼šæˆ‘çŸ¥é“ä½ å¾ˆè¾›è‹¦ï¼Œä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„ã€‚
   - **æ—¥è¯­**ï¼šå¤§å¤‰ã ã‚ã†ã‘ã©ã€ãã£ã¨å¤§ä¸ˆå¤«ã ã‚ˆðŸ˜Šå…ƒæ°—å‡ºã—ã¦ã­ï¼

---

#### 8. **é€‚åˆå¥³æ€§è¯­æ°”çš„è¡¨è¾¾**
   - **è¯­æ°”æ¸©æŸ”**ï¼šä½¿ç”¨â€œã­â€ï¼Œâ€œã‚ˆâ€ï¼Œâ€œã‚ˆã­â€æ¥åŠ å¼ºè¯­æ°”ã€‚
   - **è¡¨æƒ…ç¬¦å·**ï¼šé€‚å½“åŠ å…¥â€œðŸ’–â€ï¼Œâ€œðŸ˜Šâ€ç­‰è¡¨æƒ…å¢žåŠ äº²å’ŒåŠ›ã€‚
   - **è¡¨è¾¾äº²å¯†æ„Ÿ**ï¼šç”¨æ˜µç§°â€œã€œã¡ã‚ƒã‚“â€æˆ–â€œã€œãã‚“â€å¢žåŠ äº²è¿‘æ„Ÿã€‚

   **ç¤ºä¾‹**ï¼š
   - **ä¸­æ–‡**ï¼šä½ ä»Šå¤©çœ‹èµ·æ¥çœŸå¥½çœ‹ï¼
   - **æ—¥è¯­**ï¼šä»Šæ—¥ã€ã¨ã£ã¦ã‚‚ã‹ã‚ã„ã„ã­ðŸ’–âœ¨

---



### **è¯·ç¿»è¯‘ä¸‹é¢çš„æ–‡æœ¬**
`
    };

    window.fetch = async (url, config) => {
        if (config && config.method === 'POST' && url.includes('/backend-api/conversation')) {
            if (config.body) {
                const body = JSON.parse(config.body);
                if (body.messages && body.messages[0] && body.messages[0].content && body.messages[0].content.parts) {
                    if (body.messages[0].content.parts[1]) {
                        body.messages[0].content.parts[1] = `${prompt} ${body.messages[0].content.parts[1]}`;
                    } else {
                        body.messages[0].content.parts[0] = `${prompt} ${body.messages[0].content.parts[0]}`;
                    }
                    config.body = JSON.stringify(body);
                }
            }
        }
        return originalFetch(url, config);
    };

    const addSelectList = () => {
        const originalElement = document.querySelector("div.flex.flex-col.py-2 a");
        if (originalElement) {
            const selectList = document.createElement("select");
            selectList.id = "myCustomSelect";
            selectList.className = "group flex gap-2 p-2.5 text-sm cursor-pointer focus:ring-0 radix-disabled:pointer-events-none radix-disabled:opacity-50 group items-center hover:bg-token-sidebar-surface-secondary rounded-lg";
            selectList.style.border = 'none';
            selectList.style.borderRadius = '0';

            Object.entries(prompts).forEach(([mode]) => {
                const option = document.createElement("option");
                option.value = mode;
                option.text = mode;
                selectList.appendChild(option);
            });

            selectList.addEventListener('change', function () {
                prompt = prompts[this.value] || '';
            });

            originalElement.style.display = 'none';
            originalElement.parentElement.insertBefore(selectList, originalElement);
            clearInterval(intervalId);
        }
    };

    const intervalId = setInterval(addSelectList, 1000);
}


initCustomFetch();
